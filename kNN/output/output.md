Step 1: Loading and processing movie data...
Preprocessing finished
Step 2: Loading training data...
Train data loaded
Step 3: Finding the best k with cross-validation...
Testing k=1
Fold 1 for k=1
MSE for fold 1 and k=1: 3.957324643078833
Fold 2 for k=1
MSE for fold 2 and k=1: 4.046865301055245
Fold 3 for k=1
MSE for fold 3 and k=1: 4.303072625698324
Fold 4 for k=1
MSE for fold 4 and k=1: 3.9320297951582868
Fold 5 for k=1
MSE for fold 5 and k=1: 4.170856610800745
Average error for k=1: 4.082029795158286
Testing k=2
Fold 1 for k=2
MSE for fold 1 and k=2: 3.957324643078833
Fold 2 for k=2
MSE for fold 2 and k=2: 4.046865301055245
Fold 3 for k=2
MSE for fold 3 and k=2: 4.303072625698324
Fold 4 for k=2
MSE for fold 4 and k=2: 3.9320297951582868
Fold 5 for k=2
MSE for fold 5 and k=2: 4.170856610800745
Average error for k=2: 4.082029795158286
Testing k=3
Fold 1 for k=3
MSE for fold 1 and k=3: 3.723618870266915
Fold 2 for k=3
MSE for fold 2 and k=3: 3.9996896337678463
Fold 3 for k=3
MSE for fold 3 and k=3: 4.268621973929236
Fold 4 for k=3
MSE for fold 4 and k=3: 3.748758535071384
Fold 5 for k=3
MSE for fold 5 and k=3: 3.921322160148976
Average error for k=3: 3.9324022346368714
Testing k=4
Fold 1 for k=4
MSE for fold 1 and k=4: 3.6728739913097455
Fold 2 for k=4
MSE for fold 2 and k=4: 3.7622594661700806
Fold 3 for k=4
MSE for fold 3 and k=4: 3.870577281191806
Fold 4 for k=4
MSE for fold 4 and k=4: 3.601800124146493
Fold 5 for k=4
MSE for fold 5 and k=4: 3.8365921787709496
Average error for k=4: 3.748820608317815
Testing k=5
Fold 1 for k=5
MSE for fold 1 and k=5: 3.4771880819366854
Fold 2 for k=5
MSE for fold 2 and k=5: 3.4435133457479825
Fold 3 for k=5
MSE for fold 3 and k=5: 3.767535692116698
Fold 4 for k=5
MSE for fold 4 and k=5: 3.483860955927995
Fold 5 for k=5
MSE for fold 5 and k=5: 3.6876163873370578
Average error for k=5: 3.5719428926132837
Testing k=6
Fold 1 for k=6
MSE for fold 1 and k=6: 3.531346989447548
Fold 2 for k=6
MSE for fold 2 and k=6: 3.510397268777157
Fold 3 for k=6
MSE for fold 3 and k=6: 3.8339540657976414
Fold 4 for k=6
MSE for fold 4 and k=6: 3.383923029174426
Fold 5 for k=6
MSE for fold 5 and k=6: 3.537554314090627
Average error for k=6: 3.5594351334574794
Testing k=7
Fold 1 for k=7
MSE for fold 1 and k=7: 3.5665735567970205
Fold 2 for k=7
MSE for fold 2 and k=7: 3.5076039726877717
Fold 3 for k=7
MSE for fold 3 and k=7: 3.7614835505896957
Fold 4 for k=7
MSE for fold 4 and k=7: 3.1998758535071383
Fold 5 for k=7
MSE for fold 5 and k=7: 3.622594661700807
Average error for k=7: 3.5316263190564863
Testing k=8
Fold 1 for k=8
MSE for fold 1 and k=8: 3.514432029795158
Fold 2 for k=8
MSE for fold 2 and k=8: 3.403010552451893
Fold 3 for k=8
MSE for fold 3 and k=8: 3.63625077591558
Fold 4 for k=8
MSE for fold 4 and k=8: 3.1098696461824953
Fold 5 for k=8
MSE for fold 5 and k=8: 3.5240533829919305
Average error for k=8: 3.437523277467412
Testing k=9
Fold 1 for k=9
MSE for fold 1 and k=9: 3.4722222222222223
Fold 2 for k=9
MSE for fold 2 and k=9: 3.4621353196772193
Fold 3 for k=9
MSE for fold 3 and k=9: 3.483240223463687
Fold 4 for k=9
MSE for fold 4 and k=9: 3.232464307883302
Fold 5 for k=9
MSE for fold 5 and k=9: 3.464307883302297
Average error for k=9: 3.4228739913097455
Testing k=10
Fold 1 for k=10
MSE for fold 1 and k=10: 3.4340471756672875
Fold 2 for k=10
MSE for fold 2 and k=10: 3.477653631284916
Fold 3 for k=10
MSE for fold 3 and k=10: 3.350558659217877
Fold 4 for k=10
MSE for fold 4 and k=10: 3.254965859714463
Fold 5 for k=10
MSE for fold 5 and k=10: 3.457945375543141
Average error for k=10: 3.3950341402855373
Testing k=11
Fold 1 for k=11
MSE for fold 1 and k=11: 3.3864059590316575
Fold 2 for k=11
MSE for fold 2 and k=11: 3.387337057728119
Fold 3 for k=11
MSE for fold 3 and k=11: 3.326194909993793
Fold 4 for k=11
MSE for fold 4 and k=11: 3.158752327746741
Fold 5 for k=11
MSE for fold 5 and k=11: 3.551986343885785
Average error for k=11: 3.3621353196772192
Testing k=12
Fold 1 for k=12
MSE for fold 1 and k=12: 3.2922098075729362
Fold 2 for k=12
MSE for fold 2 and k=12: 3.3533519553072626
Fold 3 for k=12
MSE for fold 3 and k=12: 3.415735567970205
Fold 4 for k=12
MSE for fold 4 and k=12: 3.0729360645561763
Fold 5 for k=12
MSE for fold 5 and k=12: 3.419304779639975
Average error for k=12: 3.3107076350093108
Testing k=13
Fold 1 for k=13
MSE for fold 1 and k=13: 3.373680943513346
Fold 2 for k=13
MSE for fold 2 and k=13: 3.229981378026071
Fold 3 for k=13
MSE for fold 3 and k=13: 3.2960893854748603
Fold 4 for k=13
MSE for fold 4 and k=13: 3.005276225946617
Fold 5 for k=13
MSE for fold 5 and k=13: 3.360800744878957
Average error for k=13: 3.2531657355679706
Testing k=14
Fold 1 for k=14
MSE for fold 1 and k=14: 3.408597144630664
Fold 2 for k=14
MSE for fold 2 and k=14: 3.1509931719428925
Fold 3 for k=14
MSE for fold 3 and k=14: 3.3176598386095595
Fold 4 for k=14
MSE for fold 4 and k=14: 3.0810055865921786
Fold 5 for k=14
MSE for fold 5 and k=14: 3.3977343265052764
Average error for k=14: 3.2711980136561145
Testing k=15
Fold 1 for k=15
MSE for fold 1 and k=15: 3.492551210428305
Fold 2 for k=15
MSE for fold 2 and k=15: 3.073711980136561
Fold 3 for k=15
MSE for fold 3 and k=15: 3.1457169459962757
Fold 4 for k=15
MSE for fold 4 and k=15: 3.223463687150838
Fold 5 for k=15
MSE for fold 5 and k=15: 3.356455617628802
Average error for k=15: 3.2583798882681565
Testing k=16
Fold 1 for k=16
MSE for fold 1 and k=16: 3.382371198013656
Fold 2 for k=16
MSE for fold 2 and k=16: 3.136871508379888
Fold 3 for k=16
MSE for fold 3 and k=16: 3.135009310986965
Fold 4 for k=16
MSE for fold 4 and k=16: 3.2049968963376783
Fold 5 for k=16
MSE for fold 5 and k=16: 3.260397268777157
Average error for k=16: 3.223929236499069
Testing k=17
Fold 1 for k=17
MSE for fold 1 and k=17: 3.256362507759156
Fold 2 for k=17
MSE for fold 2 and k=17: 3.142613283674736
Fold 3 for k=17
MSE for fold 3 and k=17: 3.0881440099317192
Fold 4 for k=17
MSE for fold 4 and k=17: 3.1683736809435135
Fold 5 for k=17
MSE for fold 5 and k=17: 3.2423960273122283
Average error for k=17: 3.179577901924271
Testing k=18
Fold 1 for k=18
MSE for fold 1 and k=18: 3.207945375543141
Fold 2 for k=18
MSE for fold 2 and k=18: 3.2756052141527
Fold 3 for k=18
MSE for fold 3 and k=18: 3.048106765983861
Fold 4 for k=18
MSE for fold 4 and k=18: 2.9320297951582868
Fold 5 for k=18
MSE for fold 5 and k=18: 3.298727498448169
Average error for k=18: 3.152482929857231
Testing k=19
Fold 1 for k=19
MSE for fold 1 and k=19: 3.27048417132216
Fold 2 for k=19
MSE for fold 2 and k=19: 3.237585350713842
Fold 3 for k=19
MSE for fold 3 and k=19: 3.1340782122905027
Fold 4 for k=19
MSE for fold 4 and k=19: 3.070608317815022
Fold 5 for k=19
MSE for fold 5 and k=19: 3.2642768466790812
Average error for k=19: 3.195406579764122
Testing k=20
Fold 1 for k=20
MSE for fold 1 and k=20: 3.208255741775295
Fold 2 for k=20
MSE for fold 2 and k=20: 3.1250775915580387
Fold 3 for k=20
MSE for fold 3 and k=20: 3.0926443202979517
Fold 4 for k=20
MSE for fold 4 and k=20: 3.0328988206083176
Fold 5 for k=20
MSE for fold 5 and k=20: 3.169770328988206
Average error for k=20: 3.125729360645562
Best k found: 20
Optimal k found: 20
